<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="Mouldifi - A fully responsive, HTML5 based admin theme">
<meta name="keywords" content="Responsive, HTML5, admin theme, business, professional, Mouldifi, web design, CSS3">
<title>My files</title>
<script src="js/jquery.min.js"></script>
<script src="js/ajax.js"></script>

<!-- Site favicon -->
<link rel='shortcut icon' type='image/x-icon' href='images/shootShare.ico' />
<!-- /site favicon -->

<!-- Entypo font stylesheet -->
<link href="css/entypo.css" rel="stylesheet">
<!-- /entypo font stylesheet -->

<!-- Font awesome stylesheet -->
<link href="css/font-awesome.min.css" rel="stylesheet">
<!-- /font awesome stylesheet -->

<!-- Bootstrap stylesheet min version -->
<link href="css/bootstrap.min.css" rel="stylesheet">
<!-- /bootstrap stylesheet min version -->

<!-- Mouldifi core stylesheet -->
<link href="css/mouldifi-core.css" rel="stylesheet">
<!-- /mouldifi core stylesheet -->

<link href="css/mouldifi-forms.css" rel="stylesheet">

<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
      <script src="js/html5shiv.min.js"></script>
      <script src="js/respond.min.js"></script>
<![endif]-->

<script type="text/javascript">
$(document).ready(function() 
	{var user = getUrlVars()[0];
		var myFiles = "http://localhost:8080/shootShare/template/myFiles.html?"+user;
		var withFreinds = "http://localhost:8080/shootShare/template/withFreinds.html?"+user;
		var photo = "http://localhost:8080/shootShare/template/photo.html?"+user;
		var video = "http://localhost:8080/shootShare/template/video.html?"+user;
		var freinds = "http://localhost:8080/shootShare/template/freinds.html?"+user;
		var profile = "http://localhost:8080/shootShare/template/profile.html?"+user;

		document.getElementById("myFiles").href = myFiles;
		document.getElementById("withFreinds").href = withFreinds;
		document.getElementById("photo").href = photo;
		document.getElementById("video").href = video;
		document.getElementById("freinds").href = freinds;
		document.getElementById("profile").href = profile;

        $(window).load(function() 
	    {
	                $.ajax({
	                  url : 'http://localhost:8080/mavenproject1/webapi/profiles/'+user+'/Files/SharedFiles',
	                  type : 'Get',
	                  cache : false,
	                  contentType: "application/json; charset=utf-8",
	                  processData : false,
	                  dataType: 'JSON',
	                  success : function(data, textStatus, jqXHR) {
                                  	var i = 0;
                                  	data.forEach(function (d/*, index*/){
	                                  	var ligne = $("<tr></tr>");
	                                        ligne.append($("<td class="+"text-center"+">" + d.file_name + "</td>"));
	                                        ligne.append($("<td class="+"text-center"+">" + d.type + "</td>"));
	                                        ligne.append($("<td class="+"text-center"+">" + d.date + "</td>"));
	                                        ligne.append($("<td class="+"text-center"+"> <button id="+"delete"+i+"  value= "+ d.id +" onclick=delete1("+i+") > <i class="+"icon-cancel icon-larger red-color"+"></i> </button> </td>"));
	                                        ligne.append($("<td class="+"text-center"+"> <button id="+"download"+i+" value= "+ d.id +" onclick=download1("+i+") > <i class="+"icon-download icon-larger"+"></i> </button> </td>"));
	                                        $("#infoFiles").append(ligne);
	                                        i++;
                                  })
                                  	
	                  },
	                  error : function(jqXHR, textStatus, errorThrown) {
	                        $("#messages").append("<li style='color: red;'>" + "erreur" + "</li>");
	                  }
	                });
	    });

             }); 
</script>

</head>
<body>

<!-- Page container -->
<div class="page-container">

  <!-- Page Sidebar -->
  <div class="page-sidebar">
  
  		<!-- Site header  -->
		<header class="site-header">
		  <div class="site-logo"><a href="#"><img src="images/shootShare.png" width="50" height="50" alt="Shoot Share" title="Shoot Share"><h4>   <b> Shoot Share</b></h4></a></div>
		  <div class="sidebar-collapse hidden-xs"><a class="sidebar-collapse-icon" href="#"><i class="icon-menu"></i></a></div>
		  <div class="sidebar-mobile-menu visible-xs"><a data-target="#side-nav" data-toggle="collapse" class="mobile-menu-icon" href="#"><i class="icon-menu"></i></a></div>
		</header>
		<!-- /site header -->
		
		<!-- Main navigation -->
		
				<ul id="side-nav" class="main-menu navbar-collapse collapse">
			<li class="has-sub active "><a href="index.html"><i class="icon-layout"></i><span class="title">ALL Files</span></a>
				<ul class="nav">
					<li><a href="" id="myFiles"><span class="title">My files </span></a></li>
					<li><a href="" id="withFreinds"><span class="title">With freinds </span></a></li>
				</ul>
			</li>
			<li class="has-sub"><a href="collapsed-sidebar.html"><i class="icon-layout"></i><span class="title">Share Files</span></a>
				<ul class="nav collapse">
					<li><a href="" id="photo"><span class="title">Photos</span></a></li>
					<li><a href="" id="video"><span class="title">Videos</span></a></li>
				</ul>
			</li>
			<li class="has-sub"><a href="panels.html"><i class="icon-newspaper"></i><span class="title">Friends</span></a>
				<ul class="nav collapse">
					<li><a href="" id="freinds"><span class="title">List of freinds</span></a></li>
				</ul>
			</li>
		</ul>


		<!-- /main navigation -->		
  </div>
  <!-- /page sidebar -->
  
  <!-- Main container -->
  <div class="main-container">
  
	<!-- Main header -->
    <div class="main-header row">
      <div class="col-sm-6 col-xs-7">
	  
		<!-- User info -->
        <ul class="user-info pull-left">          
          <li class="profile-info dropdown"><a data-toggle="dropdown" class="dropdown-toggle" href="#" aria-expanded="false"> <img width="44" class="img-circle avatar" alt="" src="images/man-3.jpg">John Henderson <span class="caret"></span></a>
		  
			<!-- User action menu -->
            <ul class="dropdown-menu">             
              <li><a href="profile.html" id="profile"><i class="icon-user"></i>My profile</a></li>
			  <li class="divider"></li>
			  <li><a href="login.html"><i class="icon-logout"></i>Logout</a></li>
            </ul>
			<!-- /user action menu -->
			
          </li>
        </ul>
		<!-- /user info -->
		
      </div>
	  
    </div>
	<!-- /main header -->
	
	<!-- Main content -->
	<div class="main-content">
		<h1 class="page-title">Shared files with freinds</h1>
		<!-- Breadcrumb -->
		<div class="row">
			<div class="col-lg-12">
				<h3 class="title">List of my files</h3>
				<div class="table-responsive">
					<table class="table table-users table-bordered table-hover">
						<tbody>
							<tr>
								<td id="namefile" class="text-center"><strong>Name of file</strong></td>
								<td id="typefile" class="text-center">type of file (photo/video)</td>
								<td id="sizefile" class="text-center">1 mo</td>
								<td class="text-center"> <button id="button" value="aaa" class="text-center"> <i class="icon-cancel icon-larger red-color"></i></button> </td>
								<td class="text-center"> <button> <i class="icon-cancel icon-download" class="text-center"></i></button> </td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
		</div>
		<br><br><br><br><br>
		
		<!-- Footer -->
		<footer class="footer-main"> 
			
		</footer>	
		<!-- /footer -->
		
	  </div>
	  <!-- /main content -->
	  
  </div>
  <!-- /main container -->
  
</div>
<!-- /page container -->

<!--Load JQuery-->
<script src="js/jquery.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/plugins/metismenu/jquery.metisMenu.js"></script>
<script src="js/functions.js"></script>
</body>
</html>

<script type="text/javascript">
				function delete1(i){
			    	var idfile = $("#delete"+i+"").val();

				                $.ajax({
				                  url : 'http://localhost:8080/mavenproject1/webapi/profiles/6/Files/'+idfile,
				                  type : 'Delete',
				                  cache : false,
				                  contentType: "application/json; charset=utf-8",
				                  processData : false,
				                  dataType: 'JSON',
				                  success : function(data, textStatus, jqXHR) {
				                        	 window.location.href="withFreinds.html"
				                  },
				                  error : function(jqXHR, textStatus, errorThrown) {
				                        $("#messages").append("<li style='color: red;'>" + "erreur" + "</li>");
				                  }
				                });
				            }
				function download1(i){
			    	var idfile = $("#download"+i+"").val();
			    	console.log(idfile);
			      		var sendInfo = {
			           		id: idfile
			       						};

				                $.ajax({
		                          url : '',
		                          type : 'Get',
		                          cache : false,
		                          contentType : false,
		                          processData : false,
		                          dataType: 'JSON',
		                          data: JSON.stringify(sendInfo),
		                          success : function(data, textStatus, jqXHR) {
		                               console.log(data); 
		                                $("#messages").append("<li>" + "Telechargeent reussi" + "</li>");
		                          },
		                          error : function(jqXHR, textStatus, errorThrown) {
		                                $("#messages").append("<li style='color: red;'>" + "erreur" + "</li>");
		                          }
		                        });
				            }

				function getUrlVars()
					{
					    var vars = [], hash;
					    var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
					    for(var i = 0; i < hashes.length; i++)
					    {
					        hash = hashes[i].split('=');
					        vars.push(hash[0]);
					        vars[hash[0]] = hash[1];
					    }
					    return vars;
					}
</script>

